<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Texto a Voz</title>
  <!-- MDB Material Design Bootstrap -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.4.0/mdb.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha512-DxV+EoADOkOygM4IR9yXP8Sb2qwgidEmeqAEmDKIOfPRQZOWbXCzLC6vjbZyy0vPisbH2SyW27+ddLVCN+OMzQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />

</head>
<body class="bg-light">

<div class="container-fluid">
    <div class="row justify-content-center py-3" style="background-color: #FFC107;">
        <div class="col-12 text-center">
            <a href="https://resendiz1.github.io/landing2/" target="_blank">
                <img src="img/logo.png" class="img-fluid w-25" alt="">
            </a>
        </div>
        <div class="col-auto">
            <a href="https://www.facebook.com/people/JuanPanchos-Computers-Tehuac%C3%A1n/61577993078029/" target="_blank" class="btn btn-primary">
                <i class="fab fa-facebook "></i>
            </a>
        </div>
        <div class="col-auto">
            <a href="https://www.instagram.com/juanpancho75700/" target="_blank" class="btn" style="background-color: #f56040;">
                <i class="fab fa-instagram "></i>
            </a>
        </div>
        <div class="col-auto">
            <a href="https://www.tiktok.com/@juanpanchos_tehuacan" target="_blank" class="btn btn-dark">
                <i class="fab fa-tiktok "></i>
            </a>
        </div>

    </div>
</div>

<div class="container py-5">
  <div class="card shadow-3 p-4">
    <h3 class="text-center mb-4"> Convertidor de Texto a Voz</h3>

    <div class="form-outline mb-4">
      <textarea id="textInput" class="form-control" rows="5" placeholder="Escribe el texto aquí..."></textarea>
      <label class="form-label" for="textInput">Texto</label>
    </div>

    <div class="d-flex justify-content-center gap-3 mb-4">
      <button id="playBtn" class="btn btn-primary"><i class="fas fa-play"></i> Reproducir</button>
      <button id="pauseBtn" class="btn btn-warning"><i class="fas fa-pause"></i> Pausar</button>
      <button id="stopBtn" class="btn btn-danger"><i class="fas fa-stop"></i> Detener</button>
    </div>


  </div>
</div>

<!-- Font Awesome -->
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
<!-- MDB -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.4.0/mdb.min.js"></script>

<script>
  let synth = window.speechSynthesis;
  let utterance;
  let isPaused = false;

  const playBtn = document.getElementById("playBtn");
  const pauseBtn = document.getElementById("pauseBtn");
  const stopBtn = document.getElementById("stopBtn");
  const saveBtn = document.getElementById("saveBtn");

  playBtn.addEventListener("click", () => {
    let text = document.getElementById("textInput").value.trim();
    if (!text) return alert("Escribe algún texto");

    if (!utterance || synth.paused) {
      if (!utterance) {
        utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = "es-ES";

        // Resetear utterance cuando termine de hablar
        utterance.onend = () => {
          utterance = null;
          isPaused = false;
        };

        
      }
      synth.speak(utterance);
    } else if (isPaused) {
      synth.resume();
    }
    isPaused = false;
  });

  pauseBtn.addEventListener("click", () => {
    if (synth.speaking && !synth.paused) {
      synth.pause();
      isPaused = true;
    }
  });

  stopBtn.addEventListener("click", () => {
    synth.cancel();
    utterance = null;
    isPaused = false;
  });

  // Guardar audio (usando MediaRecorder para grabar el audio reproducido)
  saveBtn.addEventListener("click", async () => {
    let stream = await navigator.mediaDevices.getUserMedia({ audio: true });
    let mediaRecorder = new MediaRecorder(stream);
    let chunks = [];

    mediaRecorder.ondataavailable = e => chunks.push(e.data);
    mediaRecorder.onstop = () => {
      let blob = new Blob(chunks, { type: 'audio/wav' });
      let url = URL.createObjectURL(blob);
      let a = document.createElement('a');
      a.href = url;
      a.download = 'texto_a_voz.wav';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    };

    mediaRecorder.start();
    setTimeout(() => {
      mediaRecorder.stop();
    }, 5000); // Graba 5 segundos como ejemplo
    alert("Grabando 5 segundos de audio...");
  });
</script>


</body>
</html>
